# 编码与密码

## 一、编码基础

### ASCII

- 美国信息交换标准代码

- 是基于拉丁字母的一套电脑编码系统，主要用于显示现代英语和其他西欧语言

- 是现今最通用的单字节编码系统，并等同于国际标准ISO/IEC 646

- 标准ASCII码也叫基础ASCII码，使用7为二进制数（剩下的1位二进制为0）来表示所有的大写和小写字母，数字0到9、标点符号

- 后128个称为扩展ASCII码，许多基于x86的系统都支持使用扩展ASCII。扩展ASCII码允许将每个字符的第8位用于确定附加的128个特殊符号字符、外来语字母和图形符号

### unicode

- ASCII因为只有8位长，只能表达256种字符，所以不能满足其他国家需求

- Unicode是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案

- 使用16位的编码空间，也就是每个字符占用2个字节

### utf-8

- UTF-8是一种针对Unicode的可变长度字符编码

- 在实际传输过程中，由于不同系统平台的设计不一定一致，以及处于节省空间的目的，对Unicode编码的实现方式有所不同，所以有UTF

- UTF-8使用一至六个字节为每个字符编码

### BASE64

- Base64是一种基于64个可打印字符来表示二进制数据的表示方法

- 每6个比特为一个单元，对应某个可打印字符除了A-Z，a-z，0-9共62个字符还有“+”“/”，最后用”=“填充不能被3整除的空位

## 二、古典密码

###  （一）基本情况

- 主要考虑消息的保密性

- 对于完整性和不可否认性没有太多考虑

- 古典密码的加密是将明文的每一个字母替换为字母表中的另外一个字母

- 根据代换是对每个字母逐个进行还是对多个字母同时进行，古典密码又分为单表代换面民和夺标代换密码

### （二）CTF中通常是单表代换较多

1. 单表代换密码

- 通常特点：对每个字母逐个进行代换

- 典型有

	- 1.凯撒密码

		- 凯撒密码加密时将明文种的每个字母按字母表顺序向前或者向后移	动固定位数，作为密文

		- 如果偏移量是左移3为例

			- 明文：ABCDEFGHIJK

			- 密文：DEFGHIJKLMN

	- 2.移位密码

		- 与凯撒密码相似，最早的开始时密码是固定左移3位

		- 区别再于移位密码可以任意移动，后期不仅处理26个字母，还会处	理数字和特殊字符。参照ASCII码表进行位移

		- 思考：除了位移意外，还可以采取什么方式进行替换

	- 3.仿射密码

		- 原理

			- 仿射码的加密函数

				- E(x) = (ax + bb)(mod m)

					- x表示明文按照某种编码得到的数字

					- a和m互质

					- m是编码系统中字母的数目

			- 仿射密码的解密函数

				- D(x) = a^(-1)(x - b)(mod m)，七中a^(-1)是在Zm群	的乘法逆元

					- 乘法逆元：a*a^(-1)(mod m) = 1

## （三）多表替换加密

- 加密方式使用多个表

- 解决了单表加密的频率分析问题

### 1.PLayfair

- 该算法基于5*5的字母矩阵，该矩阵使用一个关键词构造（即密钥）

- 从左到右、从上到下顺序，填入关键词的字母（去除重复字母）后，将字母表其多于字母填入（I=J）

- 将明文两个分为一组，若出现相同字母，则用X替代最后字母

	- 若两个字母同行，则用右方字母替换

	- 若两个字母同列，则用下方字母替换

	- 若既不同行也不同列，则用矩阵对角字母替换

### 2.polybius

- 又称期盼密码

- 将给定明文加密位两两组合的特征

- 加密后结果只有5中字符

- ADEGX密码是德军在一战中使用的栏块密码

### 3.vigenere

- 使用26个字母构成字母矩矩阵，横行为明文列，纵向为密钥列

- 示例

	- 明文：come greatwall

	- 密钥：crypto

	- 扩种密钥是与明文一样长

		- 密文：efkt zfgrrltzn

### 4.其他密码类型

- 培根密码

	- 用两种不同字体，代表A和B（或者0和1），结合加密表进行加密

- 栅栏密码

	- 把明文分成N个一组，然后每组的第一个字连接起来，然后连接第二个……

	- 例子

		- 明文：THERE IS A CIPHER

		- 分组：TH ER EI SA CI PH ER

		- 取出：TEESCPE HRIAIHR

- 莫斯密码

	- 用 . 与 _ 表示，以前用于发电报

- CTF中的奇怪密码

	- 在CTF中，有很多密码算法都是出题者临时想出的，并没有真正的应用过，此类密码需要接替者思维活跃，根据现有的信息、线索和自己的敬仰，通过猜测、尝试去解题

	- 倒序加密

		- ABCDE加密后变为EDCBA

		- 有可能是单词倒序，如hello变为olleh

		- 有可能是短语+单词倒序，如hello world 加密为dlrow  olleh

	- 电脑键盘加密

		- ABCDE后变成QWERT

	- 手机键盘加密（就建）

	- 猪圈密码

